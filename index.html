<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MamoRun</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* =========================================
           ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š
           ========================================= */
        @import url('https://fonts.googleapis.com/css2?family=Barlow+Semi+Condensed:wght@600;700&family=Inter:wght@500;700&family=Varela+Round&display=swap');

        /* =========================================
           ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«
           ========================================= */
        #opening-screen {
            position: fixed;
            inset: 0; /* å…¨ç”»é¢ */
            z-index: 9999; /* æœ€å‰é¢ */
            background-color: #10b981; /* ã‚¢ãƒ—ãƒªã®ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼(Emerald-500) */
            
            /* CSSã§æ°´ç‰æ¨¡æ§˜ï¼ˆãƒ‰ãƒƒãƒˆæŸ„ï¼‰ã‚’ä½œæˆ - ã‚µã‚¤ã‚ºã‚’å¤§ããèª¿æ•´ */
            background-image: 
                radial-gradient(circle, rgba(255,255,255,0.25) 7px, transparent 7px),
                radial-gradient(circle, rgba(255,255,255,0.25) 7px, transparent 7px);
            background-size: 90px 90px; /* ãƒ‰ãƒƒãƒˆã®é–“éš”ã‚’å¤§ãã */
            background-position: 0 0, 45px 45px; /* ä½ç½®ã‚’ãšã‚‰ã—ã¦äº’ã„é•ã„ã«é…ç½® */

            display: flex;
            align-items: center;
            justify-content: center;
            
            /* ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆç”¨ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ */
            transition: opacity 0.6s ease-out, visibility 0.6s;
        }

        /* ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆæ™‚ã®çŠ¶æ…‹ */
        #opening-screen.fade-out {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ãƒ­ã‚´ */
        .opening-title {
            font-family: "Varela Round", sans-serif;
            /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º: æœ€å°3.5rem, æ¨å¥¨14vw, æœ€å¤§7rem */
            font-size: clamp(3.5rem, 14vw, 7rem);
            font-weight: 800;
            color: white;
            letter-spacing: -0.02em;

            /* æ–‡å­—ã‚’ã•ã‚‰ã«å¤ªãè¦‹ã›ã‚‹ãŸã‚ã®ç¸å–ã‚Šè¨­å®š */
            -webkit-text-stroke: 4px white;
            paint-order: stroke fill;
            
            /* å¼¾ã‚€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
            animation: bounceLogo 1.4s cubic-bezier(0.25, 1, 0.5, 1) both;
        }

        /* å¼¾ã‚€å‹•ãã®ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ  */
        @keyframes bounceLogo {
            0% {
                opacity: 0;
                transform: translateY(60px) scale(0.8);
            }
            40% {
                opacity: 1;
                transform: translateY(-20px) scale(1.1);
            }
            65% {
                transform: translateY(10px) scale(0.95);
            }
            85% {
                transform: translateY(-5px) scale(1.02);
            }
            100% {
                transform: translateY(0) scale(1);
            }
        }

        /* =========================================
           ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã®ã‚¹ã‚¿ã‚¤ãƒ«
           ========================================= */

        body {
            font-family: "Inter", "Yu Gothic Medium", "Yu Gothic", sans-serif;
            background: #f0f4f8;
            color: #475569;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
            min-height: 100dvh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        @media (min-width: 450px) {
            body {
                align-items: center;
                padding: 20px;
            }
        }

        .app-container {
            width: 100%;
            max-width: 420px;
            background: white;
            box-shadow: 0 0 50px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        @media (max-width: 449px) {
            .app-container { height: 100dvh; }
        }

        @media (min-width: 450px) {
            .app-container {
                height: 90vh;
                max-height: 850px;
                border-radius: 40px;
                border: 8px solid #fff;
                box-shadow: 0 20px 60px -10px rgba(0, 0, 0, 0.15);
            }
        }

        .scroll-view {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        .scroll-view::-webkit-scrollbar { display: none; }

        .header-bg {
            background-color: #10b981;
            padding: 3rem 1.5rem 4rem;
            border-bottom-left-radius: 40px;
            border-bottom-right-radius: 40px;
            color: white;
            text-align: center;
            box-shadow: 0 10px 30px -10px rgba(16, 185, 129, 0.5);
            position: relative;
            z-index: 10;
        }

        .app-title {
            font-family: "Varela Round", sans-serif;
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 0.5rem;
            letter-spacing: -0.03em;
            /* ãƒ¡ã‚¤ãƒ³ç”»é¢ã®æ–‡å­—ã‚‚å°‘ã—å¤ªã */
            -webkit-text-stroke: 2px white;
            paint-order: stroke fill;
        }

        .content-area {
            padding: 1.5rem;
            margin-top: -3rem;
            position: relative;
            z-index: 20;
            padding-bottom: 2rem;
        }

        .card {
            background: white;
            border-radius: 24px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            border: 2px solid #f1f5f9;
            margin-bottom: 1rem;
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .anim-up { animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        /* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  */
        input[type="datetime-local"] {
            font-family: "Barlow Semi Condensed", sans-serif;
            font-size: 1.3rem;
            color: #475569;
            background: #f8fafc;
            border: none;
            border-radius: 16px;
            padding: 1rem;
            width: 100%;
            text-align: center;
            outline: none;
            font-weight: 600;
        }
        input[type="datetime-local"]:focus {
            background: #ecfdf5;
            color: #059669;
            box-shadow: inset 0 0 0 3px #10b981;
        }

        /* ãƒ¢ãƒ¼ãƒ‰é¸æŠ */
        .mode-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }
        .mode-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem 0.2rem;
            border-radius: 20px;
            background: #f8fafc;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        .mode-btn.active {
            background: #fff;
            border-color: #10b981;
            box-shadow: 0 10px 20px -5px rgba(16, 185, 129, 0.3);
            transform: translateY(-2px);
            border-width: 3px;
        }
        .mode-icon { font-size: 1.8rem; margin-bottom: 0.25rem; }
        .mode-label { font-size: 0.85rem; font-weight: bold; color: #64748b; }
        .mode-time { font-size: 0.8rem; color: #94a3b8; font-family: "Barlow Semi Condensed", sans-serif; font-weight: 600; }
        .mode-btn.active .mode-label { color: #059669; }
        .mode-btn.active .mode-time { color: #10b981; }

        /* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ */
        .timeline { position: relative; padding-left: 20px; }
        .timeline::before {
            content: ''; position: absolute; left: 0; top: 10px; bottom: 10px; width: 4px; background: #e2e8f0; border-radius: 4px;
        }
        .timeline-item { position: relative; margin-bottom: 1.8rem; padding-left: 1.5rem; }
        .timeline-item:last-child { margin-bottom: 0; }
        .timeline-dot {
            position: absolute; left: -5px; top: 5px; width: 14px; height: 14px;
            border-radius: 50%; background: white; border: 4px solid #cbd5e1; z-index: 1;
        }
        .timeline-item.highlight .timeline-dot {
            border-color: #10b981; background: #10b981; box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.2);
        }
        .time-display { font-family: "Barlow Semi Condensed", sans-serif; letter-spacing: 0.02em; color: #475569; }
        #startTimeDisplay { color: #334155; }

        /* ãƒ•ãƒƒã‚¿ãƒ¼ */
        .footer-area {
            flex-shrink: 0; background: white; padding: 1rem 1.5rem 1.5rem;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.03); z-index: 50; width: 100%;
        }
        .btn-main {
            width: 100%; background: #10b981; color: white; font-weight: bold;
            padding: 1.2rem; border-radius: 100px; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            font-size: 1.1rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;
            transition: transform 0.2s; cursor: pointer;
        }
        .btn-main:active { transform: scale(0.98); }

        .hidden { display: none; }
    </style>
</head>

<body>

    <!-- ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ç”»é¢ -->
    <div id="opening-screen">
        <h1 class="opening-title">MamoRun</h1>
    </div>

    <!-- ã‚¢ãƒ—ãƒªæœ¬ä½“ -->
    <div class="app-container">
        <div class="scroll-view">
            <div class="header-bg">
                <h1 class="app-title">MamoRun</h1>
                <p class="text-sm opacity-90 font-medium">é€†ç®—ã—ã¦ã€ã¡ã‚‡ã†ã©ã‚ˆãå‹•ãã€‚</p>
            </div>

            <div class="content-area space-y-6">
                <!-- 1. é›†åˆæ™‚é–“ -->
                <div class="card anim-up" style="animation-delay: 0s;">
                    <label class="block text-xs font-bold text-gray-400 mb-2 tracking-widest">é›†åˆæ™‚é–“ (GOAL)</label>
                    <input type="datetime-local" id="meetingTime" onchange="calculateSchedule()">
                </div>

                <!-- 2. ãƒ¢ãƒ¼ãƒ‰é¸æŠ -->
                <div class="anim-up" style="animation-delay: 0.1s;">
                    <label class="block text-xs font-bold text-gray-400 mb-2 px-1 tracking-widest">æº–å‚™ãƒ¢ãƒ¼ãƒ‰ (MODE)</label>
                    <div class="mode-grid">
                        <div class="mode-btn" onclick="selectMode(15, this)" id="modeRush">
                            <span class="mode-icon">ğŸƒ</span><span class="mode-label">ãŠæ€¥ã</span><span class="mode-time">15 min</span>
                        </div>
                        <div class="mode-btn active" onclick="selectMode(45, this)" id="modeNormal">
                            <span class="mode-icon">â˜•ï¸</span><span class="mode-label">ã„ã¤ã‚‚ã®</span><span class="mode-time">45 min</span>
                        </div>
                        <div class="mode-btn" onclick="selectMode(90, this)" id="modePerfect">
                            <span class="mode-icon">âœ¨</span><span class="mode-label">ã—ã£ã‹ã‚Š</span><span class="mode-time">90 min</span>
                        </div>
                    </div>
                </div>

                <!-- 3. çµæœ -->
                <div id="resultArea" class="card anim-up hidden" style="animation-delay: 0.2s;">
                    <div class="timeline">
                        <div class="timeline-item highlight">
                            <div class="timeline-dot"></div>
                            <p class="text-xs font-bold text-emerald-600 mb-1">æº–å‚™ã‚¹ã‚¿ãƒ¼ãƒˆ</p>
                            <p id="startTimeDisplay" class="text-3xl font-bold leading-none time-display">--:--</p>
                            <p class="text-xs text-gray-400 mt-1">ã“ã“ã‹ã‚‰æº–å‚™é–‹å§‹</p>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <p class="text-xs font-bold text-gray-400 mb-1">å®¶ã‚’å‡ºã‚‹</p>
                            <div class="flex items-baseline gap-2">
                                <p id="leaveTimeDisplay" class="text-xl font-bold time-display">--:--</p>
                                <span class="text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded-full">ç§»å‹• 45åˆ† (ä»®)</span>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <p class="text-xs font-bold text-gray-400 mb-1">ç›®çš„åœ°ã«åˆ°ç€</p>
                            <p id="goalTimeDisplay" class="text-xl font-bold time-display">--:--</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer-area">
            <button onclick="setReminder()" class="btn-main">
                <span>ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚»ãƒƒãƒˆ</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </button>
        </div>
    </div>

    <!-- ã‚¢ãƒ©ãƒ¼ãƒˆ -->
    <div id="alertBox" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-[100]">
        <div class="bg-white p-6 rounded-3xl w-10/12 max-w-xs text-center shadow-2xl">
            <h3 class="text-xl font-bold text-emerald-600 mb-2">ãŠçŸ¥ã‚‰ã›</h3>
            <p id="alertText" class="text-gray-600 mb-6 font-medium"></p>
            <button onclick="closeAlert()" class="w-full bg-gray-100 text-gray-800 font-bold py-3 rounded-xl hover:bg-gray-200">OK</button>
        </div>
    </div>

    <script>
        const MOCK_TRAVEL_TIME_MIN = 45; 
        let currentPrepTimeMin = 45; 
        let reminderTimeoutId = null;

        document.addEventListener('DOMContentLoaded', () => {
            // ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡ (2ç§’å¾Œã«æ¶ˆãˆã‚‹)
            setTimeout(() => {
                document.getElementById('opening-screen').classList.add('fade-out');
            }, 2000);

            // åˆæœŸæ™‚åˆ»è¨­å®š
            const now = new Date();
            now.setHours(now.getHours() + 2);
            now.setMinutes(0);
            
            const toLocalISO = (d) => {
                const pad = (n) => n.toString().padStart(2, '0');
                return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`;
            };
            document.getElementById('meetingTime').value = toLocalISO(now);
            
            if ('Notification' in window && Notification.permission !== 'granted') Notification.requestPermission();
            calculateSchedule();
        });

        function selectMode(min, el) {
            currentPrepTimeMin = min;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            calculateSchedule();
        }

        function calculateSchedule() {
            const val = document.getElementById('meetingTime').value;
            if (!val) return;
            const meet = new Date(val);
            const leave = new Date(meet.getTime() - (MOCK_TRAVEL_TIME_MIN * 60000));
            const start = new Date(leave.getTime() - (currentPrepTimeMin * 60000));
            
            const fmt = { hour: '2-digit', minute: '2-digit' };
            document.getElementById('startTimeDisplay').textContent = start.toLocaleTimeString('ja-JP', fmt);
            document.getElementById('leaveTimeDisplay').textContent = leave.toLocaleTimeString('ja-JP', fmt);
            document.getElementById('goalTimeDisplay').textContent = meet.toLocaleTimeString('ja-JP', fmt);
            document.getElementById('resultArea').classList.remove('hidden');
        }

        function setReminder() {
            const val = document.getElementById('meetingTime').value;
            if (!val) return showAlert('é›†åˆæ™‚é–“ã‚’è¨­å®šã—ã¦ãã ã•ã„');
            
            const meet = new Date(val);
            const now = new Date();
            const startMs = meet.getTime() - (MOCK_TRAVEL_TIME_MIN * 60000) - (currentPrepTimeMin * 60000);
            const diff = startMs - now.getTime();

            if (diff <= 0) return showAlert('æº–å‚™é–‹å§‹æ™‚é–“ã‚’éãã¦ã„ã¾ã™ï¼');

            if (reminderTimeoutId) clearTimeout(reminderTimeoutId);
            reminderTimeoutId = setTimeout(() => {
                new Notification("MamoRun", { body: "æº–å‚™é–‹å§‹ã®æ™‚é–“ã§ã™ï¼", icon: "https://placehold.co/64x64/10b981/ffffff?text=Go" });
                showAlert('æ™‚é–“ã«ãªã‚Šã¾ã—ãŸï¼æº–å‚™ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚');
            }, diff);

            showAlert(`ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚\n${Math.ceil(diff/60000)}åˆ†å¾Œã«é€šçŸ¥ã—ã¾ã™ã€‚`);
        }

        function showAlert(m) {
            document.getElementById('alertText').innerText = m;
            document.getElementById('alertBox').classList.remove('hidden');
        }
        function closeAlert() {
            document.getElementById('alertBox').classList.add('hidden');
        }

        // ãƒ•ã‚©ãƒ³ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼
        (function(d) {
            var config = { kitId: 'ohm1sor', scriptTimeout: 3000, async: true },
            h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className="wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
        })(document);
    </script>
</body>
</html>
